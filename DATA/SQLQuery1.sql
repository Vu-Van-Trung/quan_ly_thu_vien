Create database QLThuVien
use QLThuVien
CREATE TABLE Users (
    ID INT PRIMARY KEY IDENTITY(1,1),
    Username VARCHAR(50) UNIQUE NOT NULL,
    Password NVARCHAR(100) NOT NULL, -- Nên dùng HASH thay vì lưu mật khẩu trầ  
    Role VARCHAR(20), -- VD: Admin, User
     CreatedAt DATETIME DEFAULT GETDATE()
);
-- Thêm tài khoản test
INSERT INTO Users (Username, Password, Role) VALUES ('admin', '123456', 'Admin');


select  * from Users

DROP TABLE NHAXUATBAN;

CREATE TABLE NHAXUATBAN (
    MANHAXUATBAN INT PRIMARY KEY IDENTITY,
    TENNHAXUATBAN NVARCHAR(200),
    DIACHI NVARCHAR(200),
    EMAIL NVARCHAR(100),
    THONGTINDAIDIEN NVARCHAR(200)
);
CREATE TABLE THELOAI (
    MATHELOAI INT PRIMARY KEY IDENTITY,
    TENTHELOAI NVARCHAR(200)
);
CREATE TABLE TACGIA (
    MATACGIA INT PRIMARY KEY IDENTITY,
    TENTACGIA NVARCHAR(200)
);
CREATE TABLE NHANVIEN (
    MANHANVIEN INT PRIMARY KEY IDENTITY,
    TENNHANVIEN NVARCHAR(200),
    NGAYSINH DATE,
    SODIENTHOAI NVARCHAR(20),
    DIACHI NVARCHAR(200),
    EMAIL NVARCHAR(200)
);
CREATE TABLE THETHUVIEN (
    SOTHE INT PRIMARY KEY IDENTITY,
    NGAYBATDAU DATE,
    NGAYKETTHUC DATE,
    GHICHU NVARCHAR(200)
);
CREATE TABLE DOCGIA (
    MADOCGIA INT PRIMARY KEY IDENTITY,
    TENDOCGIA NVARCHAR(200),
    DIACHI NVARCHAR(200),
    SOTHE INT,
    MAPHIEUMUON INT,

    FOREIGN KEY (SOTHE) REFERENCES THETHUVIEN(SOTHE),
    FOREIGN KEY (MAPHIEUMUON) REFERENCES PHIEUMUON(MAPHIEUMUON)
);

CREATE TABLE SACH (
    MASACH INT PRIMARY KEY IDENTITY,
    TENSACH NVARCHAR(200),
    MATAGGIA INT,
    MATHELOAI INT,
    MANHAXUATBAN INT,
    NAMSX INT,
    SOLUONG INT,
    TRANGTHAI NVARCHAR(200),
    FOREIGN KEY (MATAGGIA) REFERENCES TACGIA(MATACGIA),
    FOREIGN KEY (MATHELOAI) REFERENCES THELOAI(MATHELOAI),
    FOREIGN KEY (MANHAXUATBAN) REFERENCES NHAXUATBAN(MANHAXUATBAN)
);
CREATE TABLE PHIEUMUON (
    MAPHIEUMUON INT PRIMARY KEY IDENTITY,
    NGAYMUON DATE,
    MANHANVIEN INT,
    FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN)
);
CREATE TABLE CTPHIEUMUON (
    ID INT PRIMARY KEY IDENTITY,
    NGAYTRADK DATE,
    TRANGTHAI NVARCHAR(50),
    MAPHIEUMUON INT,
    MASACH INT,
    FOREIGN KEY (MAPHIEUMUON) REFERENCES PHIEUMUON(MAPHIEUMUON),
    FOREIGN KEY (MASACH) REFERENCES SACH(MASACH)
);
CREATE TABLE PHIEUPHAT (
    SOPHIEUPHAT INT PRIMARY KEY IDENTITY,
    NGAYLAP DATE,
    MANHANVIEN INT,
    MADOCGIA INT,

    FOREIGN KEY (MANHANVIEN) REFERENCES NHANVIEN(MANHANVIEN),
    FOREIGN KEY (MADOCGIA) REFERENCES DOCGIA(MADOCGIA)
);
CREATE TABLE CTPHIEUPHAT (
    ID INT PRIMARY KEY IDENTITY,
    NOIDUNG NVARCHAR(200),
    TONGTIEN DECIMAL(18,2),
    SOPHIEUPHAT INT,
    MASACH INT,

    FOREIGN KEY (SOPHIEUPHAT) REFERENCES PHIEUPHAT(SOPHIEUPHAT),
    FOREIGN KEY (MASACH) REFERENCES SACH(MASACH)
);

